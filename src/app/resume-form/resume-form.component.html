<button
  class="show-resume-button"
  *ngIf="!showResume"
  (click)="handleShowResume()"
>
  Show Resumes
</button>
<button class="show-resume-button" *ngIf="showResume" (click)="showForm()">
  Resume Form
</button>
<div class="resume-form-container" *ngIf="!showResume">
  <div class="form-header">
    <h1>Resume Builder</h1>
    <p>Create your professional resume</p>
  </div>

  <form
    class="resume-form"
    [formGroup]="resumeForm"
    (ngSubmit)="handleSubmit()"
  >
    <!-- Personal Information Section -->
    <div class="form-section">
      <h2 class="section-title">Personal Information</h2>

      <div class="form-row">
        <div class="form-group">
          <label for="firstName" class="form-label"
            >First Name
            <span
              *ngIf="
                resumeForm.get('firstName')?.hasValidator(Validators.required)
              "
              class="required"
              >*</span
            ></label
          >
          <input
            type="text"
            id="firstName"
            formControlName="firstName"
            class="form-control"
            placeholder="Enter your first name"
          />
          <div class="error-message">
            {{ getFieldError("firstName") }}
          </div>
        </div>

        <div class="form-group">
          <label for="lastName" class="form-label"
            >Last Name
            <span
              *ngIf="
                resumeForm.get('lastName')?.hasValidator(Validators.required)
              "
              class="required"
              >*</span
            ></label
          >
          <input
            type="text"
            id="lastName"
            formControlName="lastName"
            class="form-control"
            placeholder="Enter your last name"
          />
          <div class="error-message">{{ getFieldError("lastName") }}</div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="dateOfBirth" class="form-label"
            >Date of Birth
            <span
              *ngIf="
                resumeForm.get('dateOfBirth')?.hasValidator(Validators.required)
              "
              class="required"
              >*</span
            ></label
          >
          <input
            type="date"
            id="dateOfBirth"
            formControlName="dateOfBirth"
            class="form-control"
          />
          <div class="error-message">{{ getFieldError("dateOfBirth") }}</div>
        </div>

        <div class="form-group">
          <label for="email" class="form-label"
            >Email Address
            <span
              *ngIf="resumeForm.get('email')?.hasValidator(Validators.required)"
              class="required"
              >*</span
            ></label
          >
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            placeholder="Enter your email address"
          />
          <div class="error-message">
            {{ getFieldError("email") }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Gender </label>
        <div class="radio-group">
          <label class="radio-option">
            <input type="radio" value="male" formControlName="gender" />
            <span class="radio-custom"></span>
            Male
          </label>
          <label class="radio-option">
            <input type="radio" value="female" formControlName="gender" />
            <span class="radio-custom"></span>
            Female
          </label>
          <label class="radio-option">
            <input type="radio" value="other" formControlName="gender" />
            <span class="radio-custom"></span>
            Other
          </label>
        </div>
        <div class="error-message">{{ getFieldError("gender") }}</div>
      </div>
    </div>

    <!-- Languages Section -->
    <div class="form-section" formGroupName="languages">
      <h2 class="section-title">
        Languages
        <span
          *ngIf="resumeForm.get('languages')?.hasValidator(Validators.required)"
          class="required"
          >*</span
        >
      </h2>

      <div class="languages-grid">
        <div class="form-group">
          <label class="checkbox-option">
            <input type="checkbox" formControlName="english" />
            <span class="checkbox-custom"></span>
            English
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-option">
            <input type="checkbox" formControlName="hindi" />
            <span class="checkbox-custom"></span>
            Hindi
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-option">
            <input type="checkbox" formControlName="malayalam" />
            <span class="checkbox-custom"></span>
            Malayalam
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-option">
            <input type="checkbox" formControlName="tamil" />
            <span class="checkbox-custom"></span>
            Tamil
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-option">
            <input type="checkbox" formControlName="others" />
            <span class="checkbox-custom"></span>
            Others
          </label>
        </div>
      </div>
    </div>

    <!-- Address Section -->
    <div class="form-section">
      <h2 class="section-title">Address Information</h2>

      <div formGroupName="address">
        <div class="form-row">
          <div class="form-group">
            <label for="houseNo" class="form-label"
              >House No
              <span
                *ngIf="
                  resumeForm
                    .get('address.houseNo')
                    ?.hasValidator(Validators.required)
                "
                class="required"
                >*</span
              ></label
            >
            <input
              type="text"
              id="houseNo"
              formControlName="houseNo"
              (keydown)="allowOnlyNumbers($event)"
              class="form-control"
              placeholder="House/Flat number"
            />
            <div class="error-message">
              {{ getFieldError("address.houseNo") }}
            </div>
          </div>

          <div class="form-group">
            <label for="street" class="form-label"
              >Street
              <span
                *ngIf="
                  resumeForm
                    .get('address.street')
                    ?.hasValidator(Validators.required)
                "
                class="required"
                >*</span
              ></label
            >
            <input
              type="text"
              id="street"
              formControlName="street"
              class="form-control"
            />
            <div class="error-message">
              {{ getFieldError("address.street") }}
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="city" class="form-label"
              >City
              <span
                *ngIf="
                  resumeForm
                    .get('address.city')
                    ?.hasValidator(Validators.required)
                "
                class="required"
                >*</span
              ></label
            >
            <input
              type="text"
              id="city"
              formControlName="city"
              class="form-control"
              placeholder="City name"
            />
            <div class="error-message">{{ getFieldError("address.city") }}</div>
          </div>

          <div class="form-group">
            <label for="state" class="form-label"
              >State
              <span
                *ngIf="
                  resumeForm
                    .get('address.state')
                    ?.hasValidator(Validators.required)
                "
                class="required"
                >*</span
              ></label
            >
            <input
              type="text"
              id="state"
              formControlName="state"
              class="form-control"
              placeholder="State name"
            />
            <div class="error-message">
              {{ getFieldError("address.state") }}
            </div>
          </div>

          <div class="form-group">
            <label for="pincode" class="form-label"
              >Pincode
              <span
                *ngIf="
                  resumeForm
                    .get('address.pincode')
                    ?.hasValidator(Validators.required)
                "
                class="required"
                >*</span
              ></label
            >
            <input
              type="number"
              id="pincode"
              formControlName="pincode"
              class="form-control"
              placeholder="6-digit pincode"
              maxlength="6"
              (keydown)="allowOnlyNumbers($event)"
            />
            <div class="error-message">
              {{ getFieldError("address.pincode") }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Image Section -->
    <div class="form-section">
      <h2 class="section-title">Upload Image (optional)</h2>
      <div
        style="
          display: flex;
          flex-direction: column;
          gap: 8px;
          justify-content: center;
        "
      >
        <input type="file" (change)="onFileSelected($event)" />
      </div>
    </div>

    <!-- Experience Section -->
    <div class="form-section" formArrayName="experiences">
      <h2 class="section-title">Work Experience</h2>

      
        <div class="experience-item">
          <!-- Experience form controls would go here -->
          <div
            *ngFor="let exp of experience.controls; let i = index"
            [formGroupName]="i"
            style="margin-bottom: 5px"
          >
            <div
              style="
                display: flex;
                flex-direction: column;
                justify-content: center;
              "
            >
              <label
                >Company Name
                <span
                  *ngIf="
                    resumeForm
                      .get('experiences.' + i + '.companyName')
                      ?.hasValidator(Validators.required)
                  "
                  class="required"
                  >*</span
                ></label
              >
              <input
                type="text"
                placeholder="Company Name"
                formControlName="companyName"
                class="form-control"
                style="margin-bottom: 0px"
              />
              <div class="error-message">
                {{ getFieldError("experiences." + i + ".companyName") }}
              </div>
            </div>
            <div
              style="
                display: flex;
                flex-direction: column;
                justify-content: center;
              "
            >
              <label
                >Position
                <span
                  *ngIf="
                    resumeForm
                      .get('experiences.' + i + '.position')
                      ?.hasValidator(Validators.required)
                  "
                  class="required"
                  >*</span
                ></label
              >
              <input
                type="text"
                placeholder="Position"
                formControlName="position"
                class="form-control"
                style="margin-bottom: 0px"
              />
              <div class="error-message">
                {{ getFieldError("experiences." + i + ".position") }}
              </div>
            </div>

            <div formGroupName="experience">
              <label style="display: flex; gap: 8px; align-items: center"
                >Date of Joining
                <span
                  *ngIf="
                    resumeForm
                      .get('experiences.' + i + '.experience.startDate')
                      ?.hasValidator(Validators.required)
                  "
                  class="required"
                  >*</span
                >
                <input type="date" formControlName="startDate" />
                <div class="error-message">
                  {{
                    getFieldError("experiences." + i + ".experience.startDate")
                  }}
                </div>
              </label>
              <label style="display: flex; gap: 8px; align-items: center"
                >Date of Leaving
                <span
                  *ngIf="
                    resumeForm
                      .get('experiences.' + i + '.experience.endDate')
                      ?.hasValidator(Validators.required)
                  "
                  class="required"
                  >*</span>
                <input type="date" formControlName="endDate" />
                <div class="error-message">
                  {{
                    getFieldError("experiences." + i + ".experience.endDate")
                  }}
                </div>
                <div class="error-message" *ngIf="experience.at(i).get('experience.endDate')?.touched">
                  {{
                    getFieldError("experiences." + i + ".experience")
                  }}
                </div>
              </label>
            </div>
            <button
              type="button"
              (click)="handleDelete(i)"
              style="margin-top: 10px"
            >
              Delete
            </button>
          </div>
          <p class="placeholder-text"></p>
        </div>

        <button
          type="button"
          class="btn-add-experience"
          (click)="addExperience()"
        >
          <span>+</span> Add Experience
        </button>
      </div>
    

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="submit" class="btn-primary" *ngIf="!isEditMode" [disabled]="resumeForm.invalid">
        Generate Resume
      </button>
      <button type="submit" class="btn-primary" *ngIf="isEditMode" [disabled]="resumeForm.invalid">
        Update Resume
      </button>
    </div>
  </form>
</div>

<!-- RESUME PRINTING -->

<app-all-resume *ngIf="showResume"></app-all-resume>
